language:
  - python

python:
  - "3.4"

before_install:
  - sudo apt-get update -qq
  - sudo apt-get -y install python-software-properties software-properties-common
  - echo 'yes' | sudo add-apt-repository ppa:ondrej/php5-oldstable
  - sudo apt-get update -qq
  - sudo apt-get install -qq php5-cli php5-sqlite

install:
  - pip install -r client/requirements.txt
  - bash -c "cd client/; python setup.py install"
  - mkdir -p $HOME/.config/bush/
  - echo 'dXJsOiBodHRwOi8vMTI3LjAuMC4xOjgwODAvCg==' | base64 -d > $HOME/.config/bush/config.yaml
  - nohup bash -c "cd server/; php -S 127.0.0.1:8080" &

script:
  - cat $HOME/.config/bush/config.yaml
  - bush up client/requirements.txt
  - bush ls | grep requirements | grep requirements.txt
  - tests/client_up.sh
